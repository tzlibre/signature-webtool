<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" prefix="og: http://ogp.me/ns#"><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
    <title>TzLibre | WebTool | Sign</title>
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <meta name="msapplication-TileColor" content="#1F260B">
    <meta name="theme-color" content="#1F260B">
    <meta itemprop="image" content="https://tzlibre.github.io/tzl-shareimage.png">
    <meta property="og:image" content="https://tzlibre.github.io/tzl-shareimage.png">
    <meta property="og:title" content="TzLibre | WebTools | Sign">
    <style>
      html{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}*,*::before,*::after{-webkit-box-sizing:inherit;-moz-box-sizing:inherit;box-sizing:inherit}body,html{width:100%;padding:0;margin:0}body{background-color:#1F260B;text-align:center}.sgn-content{text-align:left;max-width:45em;margin:auto;padding:0 1em}.sgn-content>.block{padding:6em 0}.sgn-datagroup{margin-bottom:2em}.sgn-datagroup p{font-size:0.9em;margin:0;word-break:break-all}.sgn-datagroup.sgn-separator-arrow{text-align:center;font-size:2em;margin-bottom:0.5em;margin-top:-0.5em}.sgn-datagroup.sgn-separator-arrow:after{content:'\2B07'}.sgn-datagroup.sgn-separator-line{border-bottom:1px solid #fff}.sgn-datagroup-row{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex}.sgn-datagroup-row .sgn-datagroup{-webkit-flex-grow:1;flex-grow:1}#sgn-form-result{display:none}body{font-family:"Andale Mono","Lucida Console",Monaco,Consolas,"Lucida Sans Typewriter","Courier New",monospace;font-size:16px;font-weight:normal;color:#fff;text-rendering:optimizeLegibility}a{cursor:pointer;text-decoration:none;color:inherit;outline:none}a[name]{display:block}p{font-size:1em;line-height:1.6;margin:0 0 1em 0;padding:0;color:#fff}p a{text-decoration:underline}p a:hover{color:#ABE617}p.sgn-legend{font-size:0.75em;padding:0.5em 0}li{line-height:1.6;padding:0}::-moz-selection{background:#ABE617;text-shadow:none}::selection{background:#ABE617;text-shadow:none}#sgn-tosave{display:none}h2{font-size:3em;margin:0 0 1em 0;padding:0;color:#ABE617;line-height:1.25;word-break:break-all}h3{font-size:2em;margin:3em 0 1em 0;padding:0;color:#ABE617;line-height:1.25}h4{font-size:0.75em;text-transform:uppercase;margin:0;padding:0;color:#ABE617;line-height:1.5}.mark1{color:#f1c40f}.mark2{color:#f39c12}.mark3{color:#d35400}.mark4{color:#c0392b}label{display:block;font-size:0.9em;text-transform:uppercase;color:#ABE617;line-height:2.5em;cursor:pointer}input:not([type="submit"]){display:block;font-family:"Andale Mono","Lucida Console",Monaco,Consolas,"Lucida Sans Typewriter","Courier New",monospace;width:100%;border:2px solid #fff;background-color:transparent;color:#fff;font-size:1em;line-height:3em;padding:0 1em;outline:none}input:not([type="submit"]).fielderror{border-color:#f30}input[type="checkbox"]{display:inline-block;width:auto}input[type="checkbox"]+label{display:inline-block;padding-left:0.5em}input[type="submit"],button{display:block;width:100%;font-family:"Andale Mono","Lucida Console",Monaco,Consolas,"Lucida Sans Typewriter","Courier New",monospace;text-align:center;color:#1F260B;background-color:#ABE617;border:none;padding:1em 2em;font-size:1em;-webkit-transition:all .1s ease-out;-moz-transition:all .1s ease-out;-o-transition:all .1s ease-out;transition:all .1s ease-out;cursor:pointer}input[type="submit"]:disabled,button:disabled{color:#1F260B}input[type="submit"].loading,button.loading{-webkit-animation:pulse .6s infinite linear;-moz-animation:pulse .6s infinite linear;-o-animation:pulse .6s infinite linear;animation:pulse .6s infinite linear}@keyframes pulse{0%{opacity:1.0}50%{opacity:0.1}100%{opacity:1.0}}@-webkit-keyframes pulse{0%{opacity:1.0}50%{opacity:0.1}100%{opacity:1.0}}.sgn-formrow+.sgn-formrow{margin-top:1em}.sgn-submitrow{margin-top:52px}
    </style>
  </head>


  <body>

    <div class="main">

      <div class="sgn-content">

	<div class="block">

          <h2>TzLibre<br> signature webtool</h2>

          <p>This tool helps you sign your TZL claim or to dispute a wrong one. A valid cryptographic signature is needed as proof of ownership of your Tezos address. You shall input a valid signature into the <a href="https://tzlibre.github.io/sign.html">sign page</a></p>
	  <p>If you are a developer you can alternatively use our <a href="https://github.com/tzlibre/foundraiser-tools" target="_blank">command line tools</a>, a fork of the <a href="https://github.com/tezos/fourdraiser-tools" target="_blank">KYC-Tezos fundraiser-tools</a>.</p>
	  

	  <h3>Safety</h3>

	  <p>Producing a valid proof of ownership requires handling sensitive data from your Tezos contribution PDF. Don't proceed if your computer is unsafe or compromised.</p>
	  <p>To better protect your sensitive data we suggest to do as follows:</p> 

	  <ol>
	    <li>Download this page</li>
	    <li>Close all network connections</li>
	    <li>Open this page with the Firefox browser in private mode</li>
      <li>Fill in the form
	    <li>Click "Generate signature"</li>
	    <li>Verify the output</li>
	    <li>Click "Download the above data" to download the output as .TXT file</li>
	    <li>Quit your browser</li>
	    <li>Reconnect to the internet</li>
	    <li>Fill in the <a href="https://tzlibre.github.io/sign.html">sign page</a> with data in your .TXT file</li> 
	  </ol>
	  
	  <p><strong>Remember: you won't be able to change your Ethereum address afterwards, and we strongly suggest to use a brand new Ethereum address.</strong></p><br>

	  <form id="sgn-form" action="Javascript:submitForm()">
	    <div class="sgn-formrow">
	      <label for="field_tzaddress">Tezos public key hash (a/k/a Tezos address)</label>
	      <input id="field_tzaddress" type="text" placeholder="tz1..." required>
	    </div>

	    <div class="sgn-formrow">
	      <label for="field_seed">15 words secret key</label>
	      <input id="field_seed" type="text" placeholder="15 words" required>
	    </div>

	    <div class="sgn-formrow">
	      <label for="field_email">Email</label>
	      <input id="field_email" type="email" placeholder="your@email.com" required>
	    </div>

	    <div class="sgn-formrow">
	      <label for="field_password">Password</label>
	      <input id="field_password" type="text" placeholder="Y0Urp455w0rD" required>
	    </div>

	    <div class="sgn-formrow">
	      <label for="field_ethaddress">Current Ethereum address</label>
	      <input id="field_ethaddress" type="text" placeholder="0x..." required>
	    </div>

	    <div class="sgn-submitrow">
	      <input id="button_submit" type="submit" value="Generate signature">
	    </div>
	  </form>

	  <a name="txdata"></a>

	  <div id="sgn-form-result">

	    <h3>Signature Data</h3>

	    <div class="sgn-datagroup">
	      <h4>Tezos public key hash (a/k/a Tezos address)</h4>
	      <p class="mark1" id="tzl-pkh"></p>
	    </div>

	    <div class="sgn-datagroup">
	      <h4>Current Ethereum address</h4>
	      <p class="mark2" id="eth-addr"></p>
	    </div>

	    <div class="sgn-datagroup">
	      <h4>Tezos public key</h4>
	      <p class="mark2" id="tzl-pk"></p>
	    </div>

	    <div class="sgn-datagroup">
	      <h4>Cryptographic signature</h4>
	      <p class="mark2" id="eth-addr-signature"></p>
	    </div>
	    
 <div id="sgn-tosave">

   <span>TzLibre signature data:</span>

   <span>Tezos public key hash (a/k/a Tezos address)</span>
   <span id="sgn-tosave-tzl-pkh"></span>

   <span>Current Ethereum address</span>
   <span id="sgn-tosave-eth-addr"></span>

   <span>Tezos public key</span>
   <span id="sgn-tosave-tzl-pk"></span>

   <span>Cryptographic signature</span>
   <span id="sgn-tosave-eth-addr-signature"></span>


 </div>

 <button onclick="saveTextAsFile()">Download signature data</button>

	  </div>


	</div>

      </div>
    </div>

    <script>
    /** Globals **/
    
    let input = {}
    let output = {}
    
    /** Library **/
    
    function getInputElements () {
      return {
        ETH_addr: document.getElementById('field_ethaddress'),
        TZ_addr: document.getElementById('field_tzaddress'),
        mnemonic: document.getElementById('field_seed'),
        email: document.getElementById('field_email'),
        password: document.getElementById('field_password')
      }
    }
    
    function getOutputElements () {
      return {
        TZL_pkh: document.getElementById('tzl-pkh'),
        ETH_addr: document.getElementById('eth-addr'),
        TZL_pk: document.getElementById('tzl-pk'),
        ETH_addr_signature: document.getElementById('eth-addr-signature')
      }
    }
    
    function add_0x (addr) {
      if (addr.startsWith('0x')) {
        return addr
      }
    
      return '0x' + addr
    }
    
    function startLoading () {
      let button = document.getElementById('button_submit')
      button.classList.add('loading')
      button.setAttribute('disabled', true)
    }
    
    function stopLoading () {
      let button = document.getElementById('button_submit')
      button.classList.remove('loading')
      button.removeAttribute('disabled')
    }
    
    function handleGenerateDataPromise (data) {
      output = data
      console.log(output)
      let isValid = typeof output !== 'string'
    
      if (isValid) {
        showTxData(output)
        document.getElementById('sgn-form-result').style.display = 'block'
      } else {
        showFormError()
        console.error(output)
      }
      stopLoading()
    }
    
    function handleGenerateDataPromiseError (err) {
      showFormError()
      console.error(err)
      stopLoading()
    }
    
    function submitForm (event) {
      startLoading()
    
      let inputElements = getInputElements()
    
      for (let p in inputElements) {
        input[p] = inputElements[p].value
      }
      // add 0x to ETH_addr
      input.ETH_addr = add_0x(input.ETH_addr)
    
      setTimeout(function () {
        console.log(input)
        let outputPromise = generateData(input)
        outputPromise
          .then(handleGenerateDataPromise)
          .catch(handleGenerateDataPromiseError)
      }, 100)
    }
    
    function showTxData (data) {
      let outputElements = getOutputElements()
    
      for (let p in outputElements) {
        outputElements[p].innerHTML = data[p]
      }
    }
    
    function showFormError () {
      alert( 'Sorry, there\'s something wrong! Check your data carefully and try again.' )
    }
    
    // Save data
    
    function getToSaveElements () {
      return {
        TZL_pkh: document.getElementById('sgn-tosave-tzl-pkh'),
        ETH_addr: document.getElementById('sgn-tosave-eth-addr'),
        TZL_pk: document.getElementById('sgn-tosave-tzl-pk'),
        ETH_addr_signature: document.getElementById('sgn-tosave-eth-addr-signature')
      }
    }
    
    function saveTextAsFile () {
      // fill fields
      let toSaveElements = getToSaveElements()
    
      for (let p in toSaveElements) {
        toSaveElements[p].innerHTML = output[p]
      }
    
      let content = document
          .getElementById('sgn-tosave')
          .textContent
          .replace(/  +/g, '')
          .replace(/\n\n\n+/g, '\n\n')
          .replace(/^\n\n/, '')
          .replace(/\n\n$/, '')
      let contentBlob = new Blob([content], { type: 'text/plain' })
      let contentURL = window.URL.createObjectURL(contentBlob)
      let btn = document.createElement('a')
    
      btn.download = 'TzLibre-signature-data.txt'
      btn.addEventListener('click', destroyClickedElement)
      btn.innerHTML = 'Download the above data'
      btn.style.display = 'none'
      btn.href = contentURL
      document.body.appendChild(btn)
      btn.click()
    }
    
    function destroyClickedElement (el) {
      document.body.removeChild(el.target)
    }
    </script>
    
    <script>
      // #LIB
    </script>

  </body>
</html>
